name: Deploy to Upstream Environment
on:
  push:
    branches:
      - main
      - dev
  pull_request_target:
    types: [assigned, opened, edited synchronize, reopened]
    branches: [main, dev]
    
  workflow_dispatch:
    inputs:
      envSelection:
        description: 'Select Environment to Deploy'
        default: 'Select from the List'
        required: true
        type: choice
        options:
        - 'Select from the List'
        - 'Deploy To TST'
        - 'Deploy To ACC'
        - 'Deploy To PRD' 
      envName:
        description: 'Enter env name manually (tst / acc / prd)'
        required: true 
        type: string
      buildNumber:
        description: 'Enter Build Number'
        required: true 
        type: number
env:
  MY_NAME: 'Kundan'
jobs:
  print-tag:
    runs-on: ubuntu-latest
    if: true #inputs.envSelection != 'Select from the List'
    steps:
      - name: Values entered= ${{ inputs.envName }}
        run: |
             echo Env to deploy=  ${{ inputs.envSelection }} 
             echo Env to deploy= ${{ inputs.envName }} 
             echo Build No= ${{ inputs.buildNumber }}, ${{ inputs.envSelection == 'Deploy To TST' }} 
      - if: inputs.envSelection == 'Deploy To TST' && inputs.envName == 'tst' 
        name: Print the input to STDOUT
        run: echo  The values entered are  ${{ inputs.envSelection }} , ${{ inputs.envName }} , ${{ inputs.buildNumber }}, ${{ inputs.envSelection == 'Deploy To TST' }} 
      - if: inputs.envSelection == 'Deploy To ACC' && inputs.envName == 'acc'
        env:
          MY_NAME: 'Kundan-${{ inputs.envName }}'
        name: Print the input to STDOUT
        run: echo  The values entered are  ${{ inputs.envSelection }} , ${{ inputs.envName }} , ${{ inputs.buildNumber }}, ${{ inputs.envSelection == 'Deploy To ACC' }} 
      - if: inputs.envSelection == 'Deploy To PRD' && inputs.envName == 'prd' 
        env:
          MY_NAME: 'Kundan-${{ inputs.envName }}'
        name: Print the input to STDOUT
        run: echo  The values entered are  ${{ inputs.envSelection }} , ${{ inputs.envName }} , ${{ inputs.buildNumber }}, ${{ inputs.envSelection == 'Deploy To PRD' }}
      
      - name: 'CHeck env'
        run: |
             if [ ${{ inputs.envName }}  == 'tst' ]; 
             then
               echo It is tst
             else
               echo It is anything else
             fi
        shell: bash
        
  run_if:
    if:  contains(github.head_ref, 'main')
    runs-on: ubuntu-latest
    steps:
      - run: echo "The head of this PR starts with 'releases/'"
